<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Jukebox</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Jukebox</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Authors</h1>
<ul>
<li><b>Rafael Horcas Mateo</b> - email: <a href="#" onclick="location.href='mai'+'lto:'+'r.h'+'or'+'cas'+'m@'+'alu'+'mn'+'os.'+'up'+'m.e'+'s'; return false;">r.horcasm@alumnos.upm.es</a></li>
<li><b>Víctor Mendizábal Gimeno</b> - email: <a href="#" onclick="location.href='mai'+'lto:'+'v.m'+'en'+'diz'+'ab'+'al@'+'al'+'umn'+'os'+'.up'+'m.'+'es'; return false;">v.mendizabal@alumnos.upm.es</a></li>
</ul>
<p>En el proyecto Jukebox se establece una comunicación a través de un puerto USART usando STM32F446RE conectado a un ordenador. Esto permite la comunicación con un zumbador que puede reproducir melodías y cuenta con funcionalidades que se van desarrollando a lo largo del proyecto.</p>
<p>The Jukebox project establishes communication via USART port using an STM32F446RE connected to a computer. This enables communication with a buzzer capable of playing melodies. It has more functionalities that are developed throughout the project.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Version 1</h1>
<p>En la primera versión solo está habilitado el botón de usuario, el cual está conectado al <b>pin 13</b> de la <b>GPIO C</b>.</p>
<p>El sistema es capaz de identificar si se pulsa el botón y durante cuanto tiempo. Debido al funcionamiento del hardware del botón es necesario implementar un sistema anti-rebotes, que ha sido configurado a <b>150ms</b>. De esta manera, solo se pueden identificar como pulsaciones válidas aquellas con este tiempo mínimo.</p>
<p>Para la detección de las pulsaciones se ha empleado la interrupción externa 13, <b>EXTI13</b>, que llama a la rutina de interrupción <b>EXTI15_10_IRQHandler</b>. Se desarrolla en el archivo de código fuente <a href="interr_8c.html">interr.c</a>.</p>
<p>En la siguiente tabla se especifican las diferentes configuraciones necesarias para el correcto funcionamiento del botón de usuario.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parámetro   </th><th class="markdownTableHeadNone">Valor    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pin   </td><td class="markdownTableBodyNone">PC13    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Modo   </td><td class="markdownTableBodyNone">Input    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pull up/down   </td><td class="markdownTableBodyNone">No push no pull    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">EXTI   </td><td class="markdownTableBodyNone">EXTI13    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ISR   </td><td class="markdownTableBodyNone">EXTI15_10_IRQHandler    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Prioridad   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Subprioridad   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Tiempo antirebotes   </td><td class="markdownTableBodyNone">150ms   </td></tr>
</table>
<p>Para la implementación, en primer lugar, se ha desarrollado una librería basada en una máquina de estados finitos para el botón. Se puede observar el código en los siguientes ficheros:</p>
<p>Archivo de cabeceras: <a href="fsm__button_8h.html">fsm_button.h</a></p>
<p>Archivo de código fuente: <a href="fsm__button_8c.html">fsm_button.c</a></p>
<p>A continuación, se ha desarrollado el código necesario en la parte portable para la placa STM32F446RE. Además, es posible añadir más botones si se desea para versiones posteriores.</p>
<p>Archivo de cabeceras: <a href="port__button_8h.html">port_button.h</a></p>
<p>Archivo de código fuente: <a href="port__button_8c.html">port_button.c</a></p>
<h1><a class="anchor" id="autotoc_md3"></a>
Version 2</h1>
<p>En la segunda versión se habilita la comunicación serie entre la placa y el ordenador mediante una USART. Esto servirá en un futuro para enviar diferentes comandos a la placa para diferentes funcionalidades.</p>
<p>Se va a usar la <b>USART3</b>. La transmisión, <b>TX</b>, se encuentra en la <b>GPIO B</b>, en el <b>pin 10</b> y la recepción, <b>RX</b>, se encuentra en la <b>GPIO C</b>, en el <b>pin 11</b>. Para la comunicación se emplearan las propias interrupciones de la USART, RXNE y TXE. Estas llaman a la rutina de interrupción <b>USART3_IRQn</b>. Se desarrolla en el archivo de código fuente <a href="interr_8c.html">interr.c</a>.</p>
<p>Se realiza el siguiente montaje con ayuda de una protoboard. Por el momento puede parecer innecesaria pero en versiones posteriores tendrá más usos. El cable verde se corresponde con la conexión TX desde la placa. Por otro lado, el cable azul/morado se dedica a la conexión RX de la placa. <img src="docs/assets/imgs/montaje_v2.jpeg" alt="Montaje Versión 2" class="inline"/></p>
<p>En la siguiente tabla se especifican las diferentes configuraciones necesarias para el correcto funcionamiento de la USART3.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parámetro   </th><th class="markdownTableHeadNone">Valor    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Baudrate   </td><td class="markdownTableBodyNone">9600    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Data bits   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Stop bits   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Parity   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Flow control   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">USART   </td><td class="markdownTableBodyNone">USART3    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pins   </td><td class="markdownTableBodyNone">PB10 (TX) and PC11 (RX)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Mode   </td><td class="markdownTableBodyNone">Alternative    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pull up/down   </td><td class="markdownTableBodyNone">Pull up    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ISR   </td><td class="markdownTableBodyNone">USART3_IRQn    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Priority   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Subpriority   </td><td class="markdownTableBodyNone">0   </td></tr>
</table>
<p>Para la implementación, en primer lugar, se ha desarrollado una librería basada en una máquina de estados finitos para la trasmisión y recepción de datos. Se puede observar el código en los siguientes ficheros:</p>
<p>Archivo de cabeceras: <a href="fsm__usart_8h.html">fsm_usart.h</a></p>
<p>Archivo de código fuente: <a href="fsm__usart_8c.html">fsm_usart.c</a></p>
<p>A continuación, se ha desarrollado el código necesario en la parte portable para la placa STM32F446RE. Además, es posible añadir más USARTs si se desea para versiones posteriores.</p>
<p>Archivo de cabeceras: <a href="port__usart_8h.html">port_usart.h</a></p>
<p>Archivo de código fuente: <a href="port__usart_8c.html">port_usart.c</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
